# Customer Churn Prediction ML Pipeline üöÄ

![Python](https://img.shields.io/badge/Python-3.11-blue)
![FastAPI](https://img.shields.io/badge/FastAPI-0.104-green)
![XGBoost](https://img.shields.io/badge/XGBoost-2.0-orange)
![scikit-learn](https://img.shields.io/badge/scikit--learn-1.3-blue)
![Docker](https://img.shields.io/badge/Docker-ready-blue)
![License](https://img.shields.io/badge/license-MIT-green)

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

**Customer Churn Prediction** ‚Äî —ç—Ç–æ production-ready ML —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Ç–µ–ª–µ–∫–æ–º-–∫–æ–º–ø–∞–Ω–∏—è—Ö. 
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ML —Ä–µ—à–µ–Ω–∏—è: –æ—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ REST API.

### üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ –±–∏–∑–Ω–µ—Å—É?
–£–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ 5-7 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ, —á–µ–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö. –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø–æ–∫–∏–Ω—É—Ç –∫–æ–º–ø–∞–Ω–∏—é, —á—Ç–æ–±—ã –±–∏–∑–Ω–µ—Å –º–æ–≥ –≤–æ–≤—Ä–µ–º—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ —É–¥–µ—Ä–∂–∞—Ç—å.

### üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å?
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–µ (–¥–µ–º–æ–≥—Ä–∞—Ñ–∏—è, —É—Å–ª—É–≥–∏, –ø–ª–∞—Ç–µ–∂–∏)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞ (–æ—Ç 0 –¥–æ 1)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- –í—ã–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –º–æ–¥—É–ª—å–Ω–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–ª–æ–µ–≤:

### 1. Data Layer (—Å–ª–æ–π –¥–∞–Ω–Ω—ã—Ö)
- **–ó–∞–≥—Ä—É–∑–∫–∞** –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV —Ñ–∞–π–ª–æ–≤
- **–û—á–∏—Å—Ç–∫–∞** –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –≤—ã–±—Ä–æ—Å–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–û–±—Ä–∞–±–æ—Ç–∫–∞** –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### 2. Feature Layer (—Å–ª–æ–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Label Encoding)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (StandardScaler)
- **Feature Engineering** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
  - –°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥
  - –ù–∞–ª–∏—á–∏–µ —Å–µ–º—å–∏
  - –£—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

### 3. Model Layer (—Å–ª–æ–π –º–æ–¥–µ–ª–∏)
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: XGBoost (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥)
- **–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è**: 5 —Ñ–æ–ª–¥–æ–≤
- **–ú–µ—Ç—Ä–∏–∫–∏**: ROC-AUC, Precision, Recall, F1
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –º–æ–¥–µ–ª–∏ –≤ joblib —Ñ–æ—Ä–º–∞—Ç

### 4. API Layer (—Å–ª–æ–π API)
- **FastAPI** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Swagger UI** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–∏–∑–∞–π–Ω** ‚Äî —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|------------|
| –Ø–∑—ã–∫ | Python 3.11 | –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ | FastAPI | REST API |
| –ú–æ–¥–µ–ª—å | XGBoost | –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö | Pandas, NumPy | –ê–Ω–∞–ª–∏–∑ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è |
| –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ | scikit-learn | –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ |
| –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è | joblib | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker | –£–ø–∞–∫–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | Pydantic | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | logging | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | pytest | –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | Swagger, ReDoc | –û–ø–∏—Å–∞–Ω–∏–µ API |

## üìä –î–∞—Ç–∞—Å–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Telco Customer Churn** –¥–∞—Ç–∞—Å–µ—Ç (IBM/Telco):

- **7,043** –∫–ª–∏–µ–Ω—Ç–æ–≤
- **21** –ø—Ä–∏–∑–Ω–∞–∫
- **26.5%** ‚Äî –¥–æ–ª—è –æ—Ç—Ç–æ–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ (20% –¥–∞–Ω–Ω—ã—Ö) –ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| **ROC-AUC** | 0.85 | –ì–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è |
| **Accuracy** | 0.82 | –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ |
| **Precision** | 0.79 | –¢–æ—á–Ω–æ—Å—Ç—å (–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π) |
| **Recall** | 0.71 | –ü–æ–ª–Ω–æ—Ç–∞ (–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤) |
| **F1-Score** | 0.75 | –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ Precision –∏ Recall |

### –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Top-5):
1. **tenure** ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
2. **Contract** ‚Äî —Ç–∏–ø –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
3. **MonthlyCharges** ‚Äî –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
4. **TotalCharges** ‚Äî –æ–±—â–∞—è —Å—É–º–º–∞
5. **PaymentMethod** ‚Äî —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- pip (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤)
- Git (–¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)

### –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/aliyushakham/ml-churn-prediction.git
cd ml-churn-prediction

# 2. –°–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv

# 3. –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate  # –¥–ª—è Mac/Linux
# –∏–ª–∏
# venv\Scripts\activate  # –¥–ª—è Windows

# 4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 5. –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å (—Å–æ–∑–¥–∞—Å—Ç artifacts/models/latest_model.joblib)
python -m src.pipeline.training_pipeline

# 6. –ó–∞–ø—É—Å–∫–∞–µ–º API —Å–µ—Ä–≤–µ—Ä
uvicorn src.api.main:app --reload --host 0.0.0.0 --port 8000